<script type="text/javascript">
            var gpchart;

            var chartData = <%= raw @garment_categories.to_json %>;

            AmCharts.ready(function () {
                // RADAR CHART
                gpchart = new AmCharts.AmRadarChart();
                gpchart.dataProvider = chartData;
                gpchart.categoryField = "garment_type";
                gpchart.startDuration = 2;

                // VALUE AXIS
                var valueAxis = new AmCharts.ValueAxis();
                valueAxis.axisAlpha = 0.15;
                valueAxis.minimum = 0;
                valueAxis.dashLength = 3;
                valueAxis.axisTitleOffset = 20;
                valueAxis.gridCount = 5;
                gpchart.addValueAxis(valueAxis);

                // GRAPH
                var graph = new AmCharts.AmGraph();
                graph.title = "Since the dawn of time";
                graph.valueField = "total";
                graph.bullet = "round";
                graph.lineColor = "#fb5000";
                graph.balloonText = "[[value]] [[garment_type]] have been produced ";
                gpchart.addGraph(graph);               

                // WRITE
                gpchart.write("GPchartdiv");
                gpchart.validateNow();
            });
</script>
<h3 class="page-header">Garment produced of each type</h3>
<div>
    <select id="MyList"></select>
    <button class="btn btn-sm btn-default" onclick="sendChartData()">Generate</button>
</div>
<div id="GPchartdiv" style="width:100%; height:400px;"></div>
<%= raw @garment_categories.to_json %>
<hr>
<%= raw @year_list.to_json%>
<script type="text/javascript">
    window.onload = function() {
    var select = document.getElementById("MyList");
    var options = <%= @year_list%>;
    for (var i = 0; i < options.length; i++) {
        var opt = options[i];
        var el = document.createElement("option");
        el.textContent = opt;
        el.value = opt;
        select.appendChild(el);
    }
}

function sendChartData () {
    var s = document.getElementById("MyList");
    var selectedYear = s.options[s.selectedIndex].value;
    console.log(selectedYear);

    $.ajax({
        url: "/ajax/renderChart.json",
        type: "POST",
        data: {year_selected: selectedYear},
        success: function(data){AmCharts.makeChart("GPchartdiv", data);}
    });
}
</script>



